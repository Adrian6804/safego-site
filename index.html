<!DOCTYPE html>
<html lang="ro">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>SafeGo.ro | RCA Digital</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        body { background-color: #050505; color: white; font-family: sans-serif; overflow-x: hidden; }
        .btn-neon { background: rgba(255,255,255,0.05); border: 1px solid rgba(255,255,255,0.1); cursor: pointer; transition: 0.3s; }
        .btn-active { background: #39ff14 !important; color: black !important; box-shadow: 0 0 25px #39ff14; transform: scale(1.05); }
        .hidden { display: none; }
        .custom-scrollbar::-webkit-scrollbar { width: 6px; }
        .custom-scrollbar::-webkit-scrollbar-thumb { background: #39ff14; border-radius: 10px; }
        input, select { background: #000 !important; border: 1px solid rgba(255,255,255,0.1) !important; color: white !important; }
    </style>
</head>
<body class="p-6">

    <header class="flex justify-between items-center mb-12">
        <span class="text-2xl font-black italic tracking-tighter">SAFEGO<span class="text-[#39ff14]">.RO</span></span>
        <div class="px-4 py-1 border border-[#39ff14] text-[#39ff14] rounded-full text-[10px] font-bold">LOGIN</div>
    </header>

    <div class="grid grid-cols-2 gap-4 mb-10 max-w-md mx-auto">
        <div id="btn-rca" onclick="activateRca()" class="btn-neon p-8 rounded-[32px] flex flex-col items-center justify-center">
            <span class="text-3xl mb-3">ğŸš—</span>
            <p class="text-[11px] font-black uppercase tracking-widest">RCA Auto</p>
        </div>
        <div class="btn-neon p-8 rounded-[32px] flex flex-col items-center justify-center opacity-20 cursor-not-allowed">
            <span class="text-3xl mb-3">âœˆï¸</span>
            <p class="text-[11px] font-black uppercase tracking-widest">Travel</p>
        </div>
    </div>

    <div id="flow-container" class="hidden max-w-lg mx-auto space-y-6">
        
        <div id="step-dnt" class="bg-zinc-900/80 p-6 rounded-[32px] border border-white/5 backdrop-blur-xl">
            <h2 class="text-[#39ff14] font-black text-center mb-6 text-xs uppercase tracking-[0.2em]">Formular DNT General</h2>
            
            <div class="space-y-6 max-h-[450px] overflow-y-auto pr-2 custom-scrollbar text-[11px] uppercase font-bold text-zinc-400">
                
                <div class="p-4 bg-black/40 rounded-2xl space-y-3">
                    <p>SunteÈ›i interesat doar de acest tip de asigurare? *</p>
                    <div class="flex gap-6 text-white"><label class="flex items-center gap-2"><input type="radio" name="q1" checked> DA</label><label class="flex items-center gap-2"><input type="radio" name="q1"> NU</label></div>
                </div>

                <div class="p-4 bg-black/40 rounded-2xl space-y-3">
                    <p>Doresc ofertÄƒ: *</p>
                    <select id="q_off" class="w-full p-3 rounded-xl text-white outline-none">
                        <option>De la mai mulÈ›i asigurÄƒtori</option>
                        <option>De la un singur asigurÄƒtor</option>
                        <option>ReÃ®nnoire poliÈ›Äƒ la acelaÈ™i asigurÄƒtor</option>
                    </select>
                </div>

                <div class="p-4 bg-black/40 rounded-2xl space-y-3">
                    <p>Ãn cazul unui accident din vina ta: *</p>
                    <select id="q_acc" class="w-full p-3 rounded-xl text-white outline-none">
                        <option>Nu mÄƒ intereseazÄƒ nici un fel de protecÈ›ie</option>
                        <option>Vreau sÄƒ vÄƒd cum mÄƒ pot proteja È™i eu</option>
                    </select>
                </div>

                <div class="p-4 bg-black/40 rounded-2xl space-y-3">
                    <p>Calitatea dumneavoastrÄƒ: *</p>
                    <div class="flex gap-6 text-white"><label class="flex items-center gap-2"><input type="radio" name="q_qual" checked> Proprietar</label><label class="flex items-center gap-2"><input type="radio" name="q_qual"> Utilizator</label></div>
                </div>

                <div class="p-4 bg-black/40 rounded-2xl space-y-3">
                    <p>Auto este utilizat ca: *</p>
                    <select id="q_use" class="w-full p-3 rounded-xl text-white outline-none">
                        <option>Personal</option>
                        <option>Taxi / Uber</option>
                        <option>Transport marfÄƒ</option>
                    </select>
                </div>

                <div class="p-4 bg-black/40 rounded-2xl space-y-3">
                    <p>ConfirmaÈ›i conformitatea AML È™i SancÈ›iuni? *</p>
                    <div class="flex gap-6 text-white"><label class="flex items-center gap-2"><input type="radio" name="q_conf" checked> DA</label><label class="flex items-center gap-2"><input type="radio" name="q_conf"> NU</label></div>
                </div>

            </div>

            <button onclick="showStep2()" class="w-full mt-6 py-5 bg-[#39ff14] text-black font-black rounded-2xl text-[10px] uppercase tracking-widest">SalveazÄƒ È™i ContinuÄƒ</button>
        </div>

        <div id="step-form" class="hidden bg-zinc-900/80 p-8 rounded-[32px] border border-white/5">
            <div class="space-y-4">
                <input type="text" id="plate" placeholder="NR. INMATRICULARE" class="w-full p-5 rounded-2xl text-center font-black text-xl uppercase outline-none focus:border-[#39ff14]">
                <input type="text" id="cnp" placeholder="CNP PROPRIETAR" class="w-full p-5 rounded-2xl text-center font-black text-xl outline-none focus:border-[#39ff14]">
                <button onclick="startCalculation()" class="w-full py-5 bg-[#39ff14] text-black font-black rounded-2xl text-xs uppercase tracking-widest">CalculeazÄƒ PreÈ›</button>
            </div>
        </div>

        <div id="step-loading" class="hidden py-12 text-center">
            <div class="w-10 h-10 border-4 border-zinc-800 border-t-[#39ff14] rounded-full animate-spin mx-auto mb-4"></div>
            <p class="text-[9px] font-bold uppercase tracking-[0.3em] text-[#39ff14]">InterogÄƒm InsureTech V3...</p>
        </div>

        <div id="step-results" class="hidden space-y-4">
            <div id="offers-list" class="space-y-3"></div>
        </div>
    </div>

    <script>
        const API_KEY = '015f40fc-1974-4ad5-bbde-48c117a54307';
        const PROXY = "https://api.allorigins.win/raw?url=";

        function activateRca() {
            // RezolvÄƒ butonul inactiv
            document.getElementById('btn-rca').classList.add('btn-active');
            document.getElementById('flow-container').classList.remove('hidden');
        }

        function showStep2() {
            document.getElementById('step-dnt').classList.add('hidden');
            document.getElementById('step-form').classList.remove('hidden');
        }

        async function startCalculation() {
            const plate = document.getElementById('plate').value;
            const cnp = document.getElementById('cnp').value;
            if(!plate || !cnp) return alert("CompleteazÄƒ datele!");

            document.getElementById('step-form').classList.add('hidden');
            document.getElementById('step-loading').classList.remove('hidden');

            try {
                // Flux obligatoriu conform pozelor colegului
                const url = `https://insuretech.staging.insuretech.ro/api/v1/rca/quotes`;
                const res = await fetch(PROXY + encodeURIComponent(url), {
                    method: 'POST',
                    headers: { 'Content-Type': 'application/json', 'X-API-KEY': API_KEY },
                    body: JSON.stringify({ registration_number: plate, owner_id: cnp })
                });
                const data = await res.json();
                displayOffers(data.data || []);
            } catch (e) {
                alert("Eroare server. VerificÄƒ API Key.");
                document.getElementById('step-loading').classList.add('hidden');
                document.getElementById('step-form').classList.remove('hidden');
            }
        }

        function displayOffers(offers) {
            document.getElementById('step-loading').classList.add('hidden');
            document.getElementById('step-results').classList.remove('hidden');
            const list = document.getElementById('offers-list');
            list.innerHTML = offers.length ? offers.map(o => `
                <div class="bg-zinc-900/50 p-6 rounded-[24px] border border-white/5 flex justify-between items-center">
                    <div><p class="font-black text-sm uppercase">${o.insurer_name}</p><p class="text-[9px] text-zinc-500 uppercase">Clasa B${o.bm_class || 0}</p></div>
                    <p class="text-xl font-black text-[#39ff14]">${o.price} RON</p>
                </div>
            `).join('') : '<p class="text-center text-zinc-500 uppercase text-[10px]">Nicio ofertÄƒ gÄƒsitÄƒ.</p>';
        }
    </script>
</body>
</html>
